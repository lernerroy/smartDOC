sap.ui.define(["./BaseController","sap/f/LayoutType","sap/ui/model/json/JSONModel","../utils/formatters","airportprofile/libs/lodash"],function(e,t,a,r,s){"use strict";return e.extend("airportprofile.controller.Charges",{formatter:r,onInit:function(){var e=new a({title:"Contract Details"});this.setModel(e,"detailsViewModel");var t=new a({header:{}});this.setModel(t,"detailsModel");this.getRouter().getRoute("Charges").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){this.getEventBus().publish("route","charges",e.getParameter("arguments"));this.getModel("appView").setProperty("/layout",t.TwoColumnsMidExpanded);this.loadData(e.getParameter("arguments").vid)},loadData:function(e){var t=this;t.showBusyIndicator(true);var a=this.getModel("detailsModel");const r=this.getModel().sServiceUrl+"PurHeader";$.get({url:`${r}(ID=${e},IsActiveEntity=true)`,data:{$select:"extenalID,documentDate,description,status,validityFrom,validityTo,aribaIndicator",$expand:"vendor,carrier,purchaseOrganization,items"},success:function(e){var r=_.cloneDeep(e);r.airportCharges=[];r.cargos=[];r.engs=[];r.caterings=[];if(e&&e.items){e.items.forEach(function(e){if(e.lineOfBusiness==="airport"){r.airportCharges.push(e)}else if(e.lineOfBusiness==="cargo"){r.cargos.push(e)}})}delete r.items;a.setProperty("/header",r);t.showBusyIndicator(false);t.getModel("detailsViewModel").setProperty("/title",`Contract Details ${e.extenalID}`)},error:function(e){t.showBusyIndicator(false)}})}})});